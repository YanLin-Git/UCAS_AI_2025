# 桶排序

# 一、基本思想

1. 按照某种规则，将n个元素分发到k个桶里
    - 通常$k \approx n$
2. 各桶内的元素，插入排序
3. 依次联结各桶


# 二、复杂度分析

## 2.1 最差情况
试想分发之后，所有元素都放在了一个桶里...  
相当于**插入排序**，$O(n^2)$

## 2.2 平均情况

1. 整体复杂度的表达式（假设k=n）
    1. 分发阶段将n个元素分发，复杂度：$\Theta(n)$
    2. 排序阶段，第i个桶中有$n_i$个元素，插入排序的复杂度：$O(n_i^2)$
    3. 收集阶段，将k个桶联结，复杂度：$\Theta(k) = \Theta(n)$
    - 于是：
        $$
        T(n) = \Theta(n) + \sum\limits_{i=0}^{n-1} O(n_i^2)， \qquad \sum n_i=n
        $$

2. 我们需要对 $T(n)$ 求期望值：
$$
\begin{aligned}
E[T(n)] &= E \left[ \Theta(n) + \sum\limits_{i=0}^{n-1} O(n_i^2) \right] \\
&= \Theta(n) + \sum\limits_{i=0}^{n-1} O(E \left[ n_i^2 \right])
\end{aligned}
$$

3. 接下来证明这个结论：$E \left[ n_i^2 \right] = 2 - \frac 1 n$
    - ~~证明过程略~~

4. 于是：
$$
\begin{aligned}
E[T(n)] &= \Theta(n) + \sum\limits_{i=0}^{n-1} O(E \left[ n_i^2 \right]) \\
&= \Theta(n) + \sum\limits_{i=0}^{n-1} O(2 - \frac 1 n) \\
&= \Theta(n) + O(n) \\
&= \Theta(n)
\end{aligned}
$$